<template>
    <lightning-card title="üìä Salesforce Report Viewer">
        <div class="slds-p-around_medium">
            <!-- File Upload -->
            <lightning-input type="file" label="Upload JSON File" 
                             onchange={handleFileUpload} accept=".json">
            </lightning-input>
        </div>

        <!-- ‚úÖ Floating Balloon for API Response -->
        <template if:true={showBalloon}>
            <div class="balloon">
                <button class="close-btn" onclick={closeBalloon}>‚ùå</button>
                <pre>{balloonContent}</pre>
            </div>
        </template> 

        <!-- Report Table -->
        <template if:true={reportData}>
            <lightning-card title="üìë Report Data">
                <h2 class="slds-text-heading_medium slds-m-around_medium">{reportName}</h2>
                <!-- Search Box -->
                <div class="slds-m-bottom_medium">
                    <lightning-input type="search" label="Search" placeholder="Search records..." 
                                        value={searchTerm} onkeyup={handleSearch}>
                    </lightning-input>
                </div>
    
                <lightning-datatable key-field="id"
                                     data={pagedReportData}
                                     columns={columns}>
                </lightning-datatable>
            </lightning-card>

               <!-- Pagination Controls -->
               <div class="slds-p-around_medium">
                <lightning-button variant="neutral" label="Previous" 
                                  data-direction="prev" onclick={handlePageChange}
                                  disabled={isPreviousDisabled}>
                                  >
                </lightning-button>
                <span> {currentPage} of {totalPages} </span>
                <lightning-button variant="neutral" label="Next" 
                                  data-direction="next" onclick={handlePageChange}
                                  disabled={isNextDisabled}
                                 >
                </lightning-button>
            </div> 
        </template>

        <!-- Aggregates Table -->
        <template if:true={aggregateData}>
            <lightning-card title="üìà Aggregate Data">
                <lightning-datatable key-field="id"
                                     data={aggregateData}
                                     columns={aggregateColumns}>
                </lightning-datatable>
            </lightning-card>
        </template>
    </lightning-card>
</template>